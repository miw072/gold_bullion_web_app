<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="description" content="bullion management site, rare coins, gold, silver, platinum">
    <meta name="author" content="CSE134B Dream Team">
    <link rel="stylesheet" type="text/css" href="./style/style.css">
    <meta name=viewport content="width=device-width, initial-scale=.8, minimum-scale = .8, user-scalable=yes">
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
    <script src="https://cdn.firebase.com/js/client/2.2.5/firebase.js"></script>
    <script src="./js/jquery-1.11.2.min.js"></script>
    <script src="./js/Chart.js"></script>
    <script src="./js/main.js"></script>
    <script src="./js/wire3.js"></script>
    <title>My Gold - CoinFlip</title>
</head>

<body>
    <script type="text/javascript">
    loadTopNav();
    </script>
    <script type="text/javascript">
        var query = window.location.search;
        var metal_id = query.split("?")[1];
        loadSideNav(metal_id);
        function getAskBids(){
            $.ajax({
                type: "GET",
                dataType: 'text',
                url: "https://cse134b.herokuapp.com/jm",
                crossDomain : true,
                xhrFields: {
                    withCredentials: false
                }
            })
                    .done(function( csvdata ) {
                        var jsonAB = eval(csvdata);
                        if (metal_id == 1) {
                            if (jsonAB[0].oneDayPercentChange >= 0) {
                                $("#change").attr("class", "pos-change");
                                $("#change").html("+" + jsonAB[0].oneDayPercentChange.toPrecision(2) + "%");
                                $("#daily").attr("class", "pos-change");
                                $("#daily").html("+" + jsonAB[0].oneDayPercentChange.toPrecision(2) + "%");
                            } else {
                                $("#change").attr("class", "neg-change");
                                $("#change").html(jsonAB[0].oneDayPercentChange.toPrecision(2) + "%");
                                $("#daily").attr("class", "neg-change");
                                $("#daily").html(jsonAB[0].oneDayPercentChange.toPrecision(2) + "%");
                            }
                            if (jsonAB[0].fiftyTwoWeekPercentChange >= 0){
                                $("#overall").attr("class", "pos-change");
                                $("#overall").html("+" + jsonAB[0].fiftyTwoWeekPercentChange.toPrecision(2) + "%");
                            }else{
                                $("#overall").attr("class", "neg-change");
                                $("#overall").html(jsonAB[0].fiftyTwoWeekPercentChange.toPrecision(2) + "%");
                            }
                            $("#bid").html(jsonAB[0].bid);
                            $("#ask").html(jsonAB[0].ask);
                        }else if (metal_id == 2) {
                            if (jsonAB[1].oneDayPercentChange >= 0) {
                                $("#change").attr("class", "pos-change");
                                $("#change").html("+" + jsonAB[1].oneDayPercentChange.toPrecision(2) + "%");
                                $("#daily").attr("class", "pos-change");
                                $("#daily").html("+" + jsonAB[1].oneDayPercentChange.toPrecision(2) + "%");
                            } else {
                                $("#change").attr("class", "neg-change");
                                $("#change").html(jsonAB[1].oneDayPercentChange.toPrecision(2) + "%");
                                $("#daily").attr("class", "neg-change");
                                $("#daily").html(jsonAB[1].oneDayPercentChange.toPrecision(2) + "%");
                            }
                            if (jsonAB[1].fiftyTwoWeekPercentChange >= 0){
                                $("#overall").attr("class", "pos-change");
                                $("#overall").html("+" + jsonAB[1].fiftyTwoWeekPercentChange.toPrecision(2) + "%");
                            }else{
                                $("#overall").attr("class", "neg-change");
                                $("#overall").html(jsonAB[1].fiftyTwoWeekPercentChange.toPrecision(2) + "%");
                            }
                            $("#bid").html(jsonAB[1].bid);
                            $("#ask").html(jsonAB[1].ask);
                        }else if (metal_id == 3) {
                            if (jsonAB[2].oneDayPercentChange >= 0) {
                                $("#change").attr("class", "pos-change");
                                $("#change").html("+" + jsonAB[2].oneDayPercentChange.toPrecision(2) + "%");
                                $("#daily").attr("class", "pos-change");
                                $("#daily").html("+" + jsonAB[2].oneDayPercentChange.toPrecision(2) + "%");
                            } else {
                                $("#change").attr("class", "neg-change");
                                $("#change").html(jsonAB[2].oneDayPercentChange.toPrecision(2) + "%");
                                $("#daily").attr("class", "neg-change");
                                $("#daily").html(jsonAB[2].oneDayPercentChange.toPrecision(2) + "%");
                            }
                            if (jsonAB[2].fiftyTwoWeekPercentChange >= 0){
                                $("#overall").attr("class", "pos-change");
                                $("#overall").html("+" + jsonAB[2].fiftyTwoWeekPercentChange.toPrecision(2) + "%");
                            }else{
                                $("#overall").attr("class", "neg-change");
                                $("#overall").html(jsonAB[2].fiftyTwoWeekPercentChange.toPrecision(2) + "%");
                            }
                            $("#bid").html(jsonAB[2].bid);
                            $("#ask").html(jsonAB[2].ask);
                        }
                    })
                    .fail( function(xhr, textStatus, errorThrown) {
                        alert(xhr.responseText);
                        alert(textStatus);
                    });
        }
        getAskBids();
    </script>


    <section class="main-section">
        <section class="coin_wrapper">
            <div class="mobile-nav">
                <a href="wire2.html">
                    <svg class="icon icon-keyboard-arrow-left">
                        <symbol id="icon-keyboard-arrow-left" viewBox="0 0 1024 1024">
                            <title>keyboard-arrow-left</title>
                            <path class="path1" d="M657.707 696.96l-195.627-195.627 195.627-195.627-60.373-60.373-256 256 256 256z"></path>
                        </symbol>
                        <use xlink:href="#icon-keyboard-arrow-left"></use>
                    </svg>
                </a>
                MY GOLD
                <a href="wire5.html">
                    <svg class="icon icon-add">
                        <symbol id="icon-add" viewBox="0 0 1024 1024">
                            <title>add</title>
                            <path class="path1" d="M810.667 554.667h-256v256h-85.333v-256h-256v-85.333h256v-256h85.333v256h256v85.333z"></path>
                        </symbol>
                        <use xlink:href="#icon-add"></use>
                    </svg>
                </a>
            </div>
            <section class="overview-panel">
                <section class="total-value">
                    <div class="total-dollars"></div>
                    <table class="current_gold">
                        <tr>
                            <td>Daily</td>
                            <td id = "daily"></td>
                        </tr>
                        <tr>
                            <td>Overall</td>
                            <td id = "overall"></td>
                        </tr>
                    </table> 
                    <div class="total-label" id="my_gold_value"></div>

                </section>
                <section class="mobile-toggle">
                    <div class="mobile-toggle-button mtb-1 mobile-toggle-selected">
                        <svg class="icon icon-menu">
                            <symbol id="icon-menu" viewBox="0 0 1024 1024">
                                <title>menu</title>
                                <path class="path1" d="M128 768h768v-85.333h-768v85.333zM128 554.667h768v-85.333h-768v85.333zM128 256v85.333h768v-85.333h-768z"></path>
                            </symbol>
                            <use xlink:href="#icon-menu"></use>
                        </svg>
                    </div>
                    <div class="mobile-toggle-button mtb-2">
                        <svg class="icon icon-graph">
                            <symbol id="icon-graph" viewBox="0 -200 1424 1424">
                                <title>graph</title>
                                <path class="path1" d="M704 256h-192v640h192v-640zM960 448h-192v448h192v-448zM64 960v-128h64v-64h-64v-128h64v-64h-64v-128h64v-64h-64v-128h64v-64h-64v-128h64v-64h-128v1024h1024v-64h-960zM448 576h-192v320h192v-320z"></path>
                            </symbol>
                            <use xlink:href="#icon-graph"></use>
                        </svg>
                    </div>
                </section>
                <section class="market-list">
                    <section class="market-item-header" id="current-spot">
                        Current Spot
                    </section>
                    <section class="market-item-stats">
                        <table>
                            <tr>
                                <td id = "bid"></td>
                                <td id = "ask"></td>
                                <td id = "change"></td>
                            </tr>
                            <tr>
                                <td>Bid</td>
                                <td>Ask</td>
                                <td>Change</td>
                            </tr>
                        </table>
                    </section>
                </section>
            </section>
            <section class="graph-panel">
                <section class="chart-legend">
                    <div class="legend-left-half">
                        <section class="legend-item">
                            <div class="legend-item-color" id="legend-1"></div>
                            Gold Total
                        </section> 
                    </div>
                    <div class="legend-right-half">      
                        <section class="legend-item">
                            <div class="legend-item-color" id="legend-4"></div>
                            1oz Gold
                        </section>
                    </div>    
                </section>
                <div class="chart-y-label">PRICE</div>
                <div class="chart-x-label">TIME</div>
                <section class="chart-wrap">
                    <canvas id="total-chart"></canvas>
                </section>
            </section>

            <section class="my_stack">
                <table>
                    <caption>
                        <section class="label-and-search">
                            <h3>My Gold</h3>
                            <div class="stack_ctrl">
                                <input type="search" placeholder="Search"/>
                                <a href="wire5.html">
                                    <svg enable-background="new 0 0 24 24" height="24px" id="Layer_1" version="1.1" viewBox="0 0 24 24" width="24px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                    <path clip-rule="evenodd" d="M22.5,14H14v8.5c0,0.276-0.224,0.5-0.5,0.5h-4C9.224,23,9,22.776,9,22.5V14H0.5  C0.224,14,0,13.776,0,13.5v-4C0,9.224,0.224,9,0.5,9H9V0.5C9,0.224,9.224,0,9.5,0h4C13.776,0,14,0.224,14,0.5V9h8.5  C22.776,9,23,9.224,23,9.5v4C23,13.776,22.776,14,22.5,14z" fill-rule="evenodd" fill="white" />
                                </svg>
                                </a>
                            </div>
                        </section>
                    </caption>
                    <thead>
                        <tr>
                            <th class="stack_img_col">Image</th>
                            <th>Item</th>
                            <th>Qty.</th>
                            <th class="weight_compr"><span>Weight/unit (g)</span></th>
                            <th class="percent_compr"><span>% au</span></th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody id ="item_list">
                    </tbody>
                </table>
            </section>
        </section>
    </section>
    <script type="text/javascript">
    loadFooter();
    </script>
</body>

</html>
